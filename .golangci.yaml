version: "2"
run:
  build-tags:
    - generate_monad
linters:
  default: all
  disable:
    - cyclop         # Cyclomatic complexity - we have complex logic that's intentional
    - depguard
    - err113         # Dynamic errors - we use descriptive error messages
    - exhaustruct    # We don't want to fill all struct fields everywhere
    - forbidigo      # We intentionally use fmt.Print for CLI output
    - funcorder      # We organize methods logically, not alphabetically
    - funlen         # Function length - complex functions are intentional
    - gochecknoglobals # Template and type maps are fine as globals
    - gocognit       # Cognitive complexity - similar to cyclop
    - godoclint      # Godoc style for types
    - gosec
    - mnd            # Magic numbers are sometimes fine in context
    - nestif         # Nested if complexity - some nesting is necessary
    - nilnil         # Returning (nil, nil) is sometimes intentional
    - nonamedreturns
    - noinlineerr    # Inline error handling is idiomatic Go
    - paralleltest   # Test parallelization not always necessary
    - prealloc       # Micro-optimization not always needed
    - recvcheck      # Mixed receiver types are fine for small types
    - revive         # Disable overly pedantic style rules
    - tagliatelle
    - testpackage    # Internal tests are fine for testing private functions
    - varnamelen     # Short variable names are idiomatic in Go
    - wrapcheck      # We provide context in error messages already
    - wsl
  settings:
    wsl_v5:
      allow-first-in-block: true
      allow-whole-block: false
      branch-max-lines: 2
    exhaustive:
      default-signifies-exhaustive: true
    funlen:
      # Checks the number of lines in a function.
      # If lower than 0, disable the check.
      # Default: 60
      lines: 120
      # Checks the number of statements in a function.
      # Default: 40
      statements: 70
      # Ignore comments when counting lines.
      # Default false
      ignore-comments: true
    gocritic:
      disabled-checks:
        - newDeref # *new(T) is not a mistake
    nestif:
      # Maximum nesting depth
      min-complexity: 30
    ireturn:
      allow:
        - empty
        - error
        - stdlib
        - anon
        - generic
    nlreturn:
      block-size: 2
    revive:
      rules:
        - name: exported
          disabled: true  # We intentionally use verbose names for clarity
    varnamelen:
      max-distance: 6
      ignore-names:
        - tt # tt is shortname for testCase in table driven tests
        - wg # wg is shortname for WaitGroup
        - mu # mu is shortname for Mutex
        - xs # xs is shortname for []X
        - ys # ys is shortname for []Y
        - zs # zs is shortname for []Z
        - ch # ch is shortname for channel
        - i # i is shortname for index
        - j # j is shortname for index
        - k # k is shortname for index
        - it # it is shortname for item or iterator
  exclusions:
    # Which dirs to exclude: issues from them won't be reported.
    generated: lax
    presets:
      - comments
      - common-false-positives
      - legacy
      - std-error-handling
    paths:
      - vendor
      - third_party
      - testdata
formatters:
  enable:
    - gci
    - gofmt
    - goimports
  settings:
    gci:
      sections:
        - blank # Blank section: contains all blank imports. This section is not present unless explicitly enabled.
        - dot # Dot section: contains all dot imports. This section is not present unless explicitly enabled.
        - standard # Standard section: captures all standard packages.
        - default # Default section: contains all imports that could not be matched to another section type.
        - alias # Alias section: contains all alias imports. This section is not present unless explicitly enabled.
        - localmodule # Local module section: contains all local packages. This section is not present unless explicitly enabled.
      custom-order: true
  exclusions:
    # Which dirs to exclude: style from them won't be formatted.
    generated: lax
    paths:
      - vendor
      - third_party
      - testdata
